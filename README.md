# Домашнее задание к занятию «Базы данных, их типы» - Кищенко Сергей FOPS-41


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

---

# Домашнее задание к занятию «Базы данных, их типы»

## Задание 1. СУБД

Кейс  
Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с    данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.  
Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?  
1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать    целостность и чёткую структуру данных.  
1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?  
1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по     продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.    
1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?    
1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно   структуре компании. СУБД должна иметь простую и понятную структуру.  
1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?  
1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению   курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.  
1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?  
1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?  
Приведите ответ в свободной форме.  

## Решение 1

### 1.1. Бюджетирование проектов + аналитика + прогнозирование рисков  

✔ Требования:  
- строгая структура данных  
- гарантия целостности  
- сложные связи  
- аналитические отчёты  
- прогнозирование  

подходит Реляционная (SQL): PostgreSQL или Oracle  
 
- транзакционность (ACID)  
- строгие схемы и контроль целостности  
- хорошие возможности аналитики (window functions, CTE, materialized views)  
- идеально подходит для построения финансовых отчётов  
- можно подключить BI-инструменты (Power BI, Metabase, ClickHouse + FDW)  

1.1* 
Используют API аппаратного ускорения вычислений, например: Intel SHA Extensions / AES-NI / AVX-512  

### 1.2. Лендинги + CRM маркетологов   
Требования для лендинга:   
- высокая скорость записи  
- горизонтальная масштабируемость  
- отсутствие строгих схем  
- сбор лидов в большом объёме  

подходит NoSQL: MongoDB / Redis / Cassandra  

Требования для CRM:  

- транзакционность  
- строгая структура  
- гарантированная целостность  
- отчёты, статусы, связи «клиент–заказ–взаимодействия»  

подходит SQL: PostgreSQL / MySQL / MS SQL  

1.2* Можно ли закрыть одной СУБД?*

Да — PostgreSQL с расширениями: PostgreSQL + JSONB  

- хранение лидов в JSON (как NoSQL)  
- CRM в нормализованных таблицах  
- хорошая скорость операций  

### 1.3. База для норм, правил, обучающих материалов

Требования:
- простая структура  
- иерархия разделов  
- текстовый контент  

подходит Документная СУБД — MongoDB  

- идеально подходит для хранения "документов", файлов, правил, разделов  
- идеально работает с вложенными структурами (раздел → подраздел → документ)  

1.3.* Можно ли использовать существующую СУБД из задач выше?  

Да. Если выбрали PostgreSQL, можете сделать:  

- таблица documents(id, title, content JSONB)  
- дерево через ltree или closure table  

### 1.4. Логистика: маршруты, курьеры, объекты доставки  

Требования:  

- поиск кратчайшего пути  
- быстрое вычисление связей  
- маршрутизация  
- алгоритмы графов  

подходит Графовая СУБД — Neo4j

- вершины: объекты/курьеры  
- рёбра: дороги/маршруты  
- быстрый поиск пути: A*, Dijkstra  
- язык Cypher прекрасно подходит для логистики  

1.4.* Подключить отдел закупок?

Да, если: закупки сильно связаны с логистикой и требуется видеть маршруты поставок.  
Если закупки полностью отдельная структура (поставщики, счета, акты) — лучше SQL (PostgreSQL), а логистику в Neo4j оставить в отдельной СУБД.  

### 1.5. Можно ли всё решить одной СУБД?  

PostgreSQL способен покрыть почти всё:

- Задача	Решение в PostgreSQL  
- Бюджетирование	строгие схемы, ACID  
- Лендинги	JSONB + индексы GIN  
- CRM	нормализованные таблицы  
- База знаний	JSONB / ltree  
- Логистика	pgRouting (расширение PostGIS)   

Самое универсальное решение — PostgreSQL + расширения.  

## Задание 2. Транзакции

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.  
2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?  

Приведите ответ в свободной форме.  

## Решение 2

### 2.1. Пользователь пополняет баланс счета телефона  

Пошаговая транзакция (6 шагов):

- Пользователь отправляет запрос на оплату (платёжка → банк/оператор).  
- Система резервирует деньги на банковском счёте клиента.  
- Система оператора связи создаёт транзакцию с начальным статусом («в обработке»).  
- Платёж подтверждается банком — деньги списываются.  
- Оператор связи увеличивает баланс телефона (ACID-транзакция).  
- Система отправляет подтверждение пользователю и банку.  

2.1.* Если пополнение через автоплатёж  

Добавляется ещё 2 шага:  

- Триггер автоплатежа (например, каждый понедельник или при балансе < 100₽).  
- Проверка лимитов и условий автоплатежа.  
  Далее — всё как в ручной транзакции.  


## ЗАДАНИЕ 3 — SQL vs NoSQL  

3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL.  
3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.  

Приведите ответ в свободной форме.  

## Решение 3

### 3.1. Пять преимуществ SQL над NoSQL  

- ACID-транзакции — гарантия целостности данных.  
- Строгая схема — меньше ошибок в данных.  
- Сложные запросы: JOIN, GROUP BY, WINDOW FUNCTIONS.  
- Надёжные средства резервного копирования и репликации.  
- Поддержка триггеров, процедур и ограничений (FOREIGN KEY, UNIQUE).  

### 3.1* Преимущества NewSQL над SQL и NoSQL  

NewSQL = масштабируемость NoSQL + транзакционность SQL  

- Горизонтальная масштабируемость (как NoSQL).  
- Полная поддержка ACID (как SQL).  
- Высокая производительность и распределённая обработка.  
- Поддержка SQL-запросов.  
- Подходит для больших распределённых систем (банки, финансы).  

Примеры NewSQL:  
- Google Spanner  
- CockroachDB  
- YugabyteDB  
  
## Задание 4. Кластеры  

Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу выделено 1000 машин.  
На основе какого критерия будете выбирать тип СУБД и какая модель распределённых вычислений здесь справится лучше всего и почему?  
 
Приведите ответ в свободной форме.  

## Решение 4  

Главный критерий выбора: тип нагрузки  

Если нагрузка:  

1) Аналитическая (Big Data)  

Нужны системы распределённых вычислений:  

- Apache Hadoop (HDFS) + Hive  
- Apache Spark + Delta Lake  
- ClickHouse distributed cluster  

горизонтальное масштабирование  
хранение и обработка петабайт данных  
быстрые распределённые вычисления  

2) Онлайн-операции (OLTP)  

подходит NewSQL: CockroachDB или Google Spanner  
 
- ACID  
- масштабирование на тысячи машин  
- fault-tolerance  